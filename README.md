# 절차적 지도 생성 기법

절차적 지도 생성(Procedural Map Generation) 기법들을 설명하고 파이썬으로 구현한 페이지입니다.  
The same descriptions in English can be found at  [README(ENG).md](README(Eng).md).  

이 페이지는 개인 코딩 역량 증가와 게임 알고리즘 이해를 돕기위해 정리한 개인 프로젝트입니다.  
가장 최적화된 방법을 찾는게 아닌 알고리즘의 흐름을 이해하고 직접 구현해보자에 초점이 맞춰져 있기 때문에 틀리거나 비효율적인 점이 다소 존재할 수 있습니다.
  

**Work in progress**

## 개요
![로그](images/로그.png)

로그라이크(Roguelike) 장르는 1980년에 탄생한 게임 Rogue의 특징과 시스템을 모방하여 만든 게임입니다. 
로그라이크의 여러 특징 중 절차적 지도 생성(Procedural Map Generation)기법은 원래 메모리의 한계를 극복하기 위해 개발된 기법이지만,
이론상 거의 무한에 가까운 가능성을 생성할 수 있다는 장점은 어느 게임이든 탐낼 수 밖에 없습니다.
실제로 Rogue 직후 발매된 게임들은 물론 최근에 발매된 게임들도 어느정도 요소를 채용하고 있습니다.
이 페이지는 2D 절차적 지도생성에 사용되는 기법과 알고리즘을 각각 소개하고, 그 알고리즘을 직접 파이썬으로 구현한걸 정리하기위해 만들어졌습니다.
각 기법마다 설명, 작동 방법, 파이썬 구현 코드, 데모 링크까지 추가할 예정입니다.

#### !! Shout out !!
- Cogmind: 제가 로그라이크에 대해 관심가지게 만든 게임 입니다.
- Rogue: 장르를 만들정도의 파급력을 가진 게임 요소를 처음으로 만든 게임입니다.
- [Herbert Wolverson - Procedural Map Generation Techniques](https://www.youtube.com/watch?v=TlLIOgWYVpI): 절차적 생성 알고리즘을 잘 설명해주고 시각화 해준 강의입니다. 사실상 이 페이지는 이 영상 실습편입니다.  

## Simple Room Placements

가장 기초가 되는 지도 생성 방법입니다. 방의 크기나 모양을 정하는 알고리즘에 따라 지도의 형태가 달라질 수 있습니다. Rogue의 경우 9개의 방을 생성하고 복도로 이어주는 방법으로 맵을 생성하였습니다.
이 세션에선 방을 어떤식으로 만드느지에 관해서 정리하였습니다. 추가 내용이 없다면 예시에서 지도의 크기는 40x30, 방의 크기는 가로세로 모두 2이상이고 10미만인 정수이며 서로다른 방은 인접할 수 없습니다.
 
### 기본 알고리즘
1. 지도를 벽으로 채운다.
2. 방의 위치와 크기를 정한다. 만약 그 자리에 방이 존재하지 않는다면 생성한다.
3. 계속 방을 생성한다.
4. 복도로 방을 잇는다.

### 방 생성 방법
#### 완전 랜덤
![완전 랜덤](images/Random_Room_Gen.JPG)

code: [Random_Room_Gen](Random_Room_Gen.py)  
demo: WIP  

순수하게 다른 알고리즘 없이 랜덤으로 생성하는 방법입니다. 방은 단순하게 왼쪽 위를 앵커로 가로세로를 랜덤하게 구하였습니다.
1. 앵커의 좌표를 각각 0<=x좌표<map_width-2, 0<=y좌표<map_height-2인 정수중 랜덤으로 구합니다. 이때 map_width-2인 이유는 오른쪽과 아래에 칸1개짜리 방이 생기는것을 방지하기 위해서 입니다.
2. 가로와 세로 높이를 3<=가로,세로<10인 정수중 랜덤으로 구합니다.
3. 설정한 영역과 그 주변 1칸까지 기존 방이 없으면(최대값이 0이면) 방으로 표시합니다.

#### BSP Rooms
Binary Space Partition Rooms의 약자로 Nethack에서 사용되었습니다. 랜덤 생성 방법과 유사하지만 더 방이 고르게 분포되게 만들 수 있습니다.
나누는 비율을 절반이 아닌 숫자로 정하면 더 유기적인 방을 생성할 수 있습니다.
1. 맵을 한개의 구역으로 정한다.
2. 구역을 랜덤으로 하나 정한다.
3. 구역을 가로 혹은 세로(랜덤 선택)로 나눈다.
4. 원하는 개수의 구역이 생성될 때 까지 2,3번을 반복한다.
5. 각 구역마다 한개 이하의 방을 생성한다.





